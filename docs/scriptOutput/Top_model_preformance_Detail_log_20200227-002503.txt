
(keras-gpu) C:\Users\hijoh\OneDrive - Kapsch Group\Documents\MMAI\MMAI894\MMAI-894-Team-Adelaide>python 3_Classes\modelBaseFromBestStructure.py
2020-02-27 00:24:59.385171: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-02-27 00:25:03.093538: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library nvcuda.dll
2020-02-27 00:25:03.140711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties:
name: GeForce GTX 1080 major: 6 minor: 1 memoryClockRate(GHz): 1.8475
pciBusID: 0000:09:00.0
2020-02-27 00:25:03.144542: I tensorflow/stream_executor/platform/default/dlopen_checker_stub.cc:25] GPU libraries are statically linked, skip dlopen check.
2020-02-27 00:25:03.147723: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-02-27 00:25:03.150201: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX AVX2
2020-02-27 00:25:03.176304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties:
name: GeForce GTX 1080 major: 6 minor: 1 memoryClockRate(GHz): 1.8475
pciBusID: 0000:09:00.0
2020-02-27 00:25:03.180130: I tensorflow/stream_executor/platform/default/dlopen_checker_stub.cc:25] GPU libraries are statically linked, skip dlopen check.
2020-02-27 00:25:03.183393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-02-27 00:25:03.702144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-02-27 00:25:03.705205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0
2020-02-27 00:25:03.706754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N
2020-02-27 00:25:03.709106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 5800 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:09:00.0, c
ompute capability: 6.1)
1 Physical GPUs, 1 Logical GPUs
Found 2321 images belonging to 3 classes.
Found 663 images belonging to 3 classes.
Found 333 images belonging to 3 classes.
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d (Conv2D)              (None, 147, 147, 32)      1568
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 73, 73, 32)        0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 70, 70, 32)        16416
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 35, 35, 32)        0
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 32, 32, 64)        32832
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 16, 16, 64)        0
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 13, 13, 128)       131200
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 6, 6, 128)         0
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 3, 3, 256)         524544
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 1, 1, 256)         0
_________________________________________________________________
flatten (Flatten)            (None, 256)               0
_________________________________________________________________
dense (Dense)                (None, 512)               131584
_________________________________________________________________
activation (Activation)      (None, 512)               0
_________________________________________________________________
dense_1 (Dense)              (None, 3)                 1539
=================================================================
Total params: 839,683
Trainable params: 839,683
Non-trainable params: 0
_________________________________________________________________
None
37 156
Epoch 1/30
2020-02-27 00:25:05.027887: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-02-27 00:25:05.715031: W tensorflow/stream_executor/cuda/redzone_allocator.cc:312] Internal: Invoking ptxas not supported on Windows
Relying on driver to perform ptx compilation. This message will be only logged once.
2020-02-27 00:25:05.868055: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-02-27 00:25:06.320343: I tensorflow/core/profiler/lib/profiler_session.cc:184] Profiler session started.
2020-02-27 00:25:06.328731: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'cupti64_100.dll'; dlerror: cupti64_100.dll not found
2020-02-27 00:25:06.332000: W tensorflow/core/profiler/lib/profiler_session.cc:192] Encountered error while starting profiler: Unavailable: CUPTI error: CUPTI could not be loaded or symbol could not be found.
  1/156 [..............................] - ETA: 4:19 - loss: 1.0989 - accuracy: 0.31252020-02-27 00:25:06.472013: I tensorflow/core/platform/default/device_tracer.cc:588] Collecting 0 kernel records, 0 memcpy records.
2020-02-27 00:25:06.482455: E tensorflow/core/platform/default/device_tracer.cc:70] CUPTI error: CUPTI could not be loaded or symbol could not be found.
156/156 [==============================] - 67s 427ms/step - loss: 1.0915 - accuracy: 0.3845 - val_loss: 1.0774 - val_accuracy: 0.3836
Epoch 2/30
156/156 [==============================] - 61s 393ms/step - loss: 0.9879 - accuracy: 0.4884 - val_loss: 0.9116 - val_accuracy: 0.5396
Epoch 3/30
156/156 [==============================] - 61s 390ms/step - loss: 0.8779 - accuracy: 0.5684 - val_loss: 0.8571 - val_accuracy: 0.5883
Epoch 4/30
156/156 [==============================] - 61s 388ms/step - loss: 0.8448 - accuracy: 0.5929 - val_loss: 0.8273 - val_accuracy: 0.6082
Epoch 5/30
156/156 [==============================] - 64s 407ms/step - loss: 0.8029 - accuracy: 0.6198 - val_loss: 0.8089 - val_accuracy: 0.6187
Epoch 6/30
156/156 [==============================] - 63s 407ms/step - loss: 0.7809 - accuracy: 0.6385 - val_loss: 0.7937 - val_accuracy: 0.6207
Epoch 7/30
156/156 [==============================] - 64s 409ms/step - loss: 0.7556 - accuracy: 0.6532 - val_loss: 0.7500 - val_accuracy: 0.6495
Epoch 8/30
156/156 [==============================] - 64s 408ms/step - loss: 0.7503 - accuracy: 0.6504 - val_loss: 0.7359 - val_accuracy: 0.6671
Epoch 9/30
156/156 [==============================] - 63s 401ms/step - loss: 0.7291 - accuracy: 0.6644 - val_loss: 0.7151 - val_accuracy: 0.6717
Epoch 10/30
156/156 [==============================] - 64s 410ms/step - loss: 0.7151 - accuracy: 0.6687 - val_loss: 0.7141 - val_accuracy: 0.6616
Epoch 11/30
156/156 [==============================] - 61s 390ms/step - loss: 0.7033 - accuracy: 0.6843 - val_loss: 0.6744 - val_accuracy: 0.6940
Epoch 12/30
156/156 [==============================] - 61s 391ms/step - loss: 0.6949 - accuracy: 0.6870 - val_loss: 0.7190 - val_accuracy: 0.6713
Epoch 13/30
156/156 [==============================] - 62s 396ms/step - loss: 0.6881 - accuracy: 0.6869 - val_loss: 0.6588 - val_accuracy: 0.7006
Epoch 14/30
156/156 [==============================] - 64s 407ms/step - loss: 0.6754 - accuracy: 0.6937 - val_loss: 0.6577 - val_accuracy: 0.7053
Epoch 15/30
156/156 [==============================] - 62s 397ms/step - loss: 0.6863 - accuracy: 0.6956 - val_loss: 0.6657 - val_accuracy: 0.6881
Epoch 16/30
156/156 [==============================] - 62s 397ms/step - loss: 0.6577 - accuracy: 0.7068 - val_loss: 0.6393 - val_accuracy: 0.7228
Epoch 17/30
156/156 [==============================] - 61s 392ms/step - loss: 0.6476 - accuracy: 0.7145 - val_loss: 0.6653 - val_accuracy: 0.7041
Epoch 18/30
156/156 [==============================] - 61s 392ms/step - loss: 0.6445 - accuracy: 0.7061 - val_loss: 0.6498 - val_accuracy: 0.7103
Epoch 00018: early stopping
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d (Conv2D)              (None, 147, 147, 32)      1568
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 73, 73, 32)        0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 70, 70, 32)        16416
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 35, 35, 32)        0
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 32, 32, 64)        32832
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 16, 16, 64)        0
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 13, 13, 128)       131200
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 6, 6, 128)         0
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 3, 3, 256)         524544
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 1, 1, 256)         0
_________________________________________________________________
flatten (Flatten)            (None, 256)               0
_________________________________________________________________
dense (Dense)                (None, 512)               131584
_________________________________________________________________
activation (Activation)      (None, 512)               0
_________________________________________________________________
dense_1 (Dense)              (None, 3)                 1539
=================================================================
Total params: 839,683
Trainable params: 839,683
Non-trainable params: 0
_________________________________________________________________
None
11/11 [==============================] - 1s 49ms/step - loss: 0.5613 - accuracy: 0.7538
[0.561326723207127, 0.7537538]
11/11 [==============================] - 0s 38ms/step
Confusion Matrix
[[ 51   9  38]
 [  7 117   5]
 [ 16   7  83]]
Classification Report
              precision    recall  f1-score   support

    bacteria       0.69      0.52      0.59        98
      normal       0.88      0.91      0.89       129
       virus       0.66      0.78      0.72       106

    accuracy                           0.75       333
   macro avg       0.74      0.74      0.73       333
weighted avg       0.75      0.75      0.75       333

[0.561326723207127, 0.7537538]
Found 2321 images belonging to 3 classes.
Found 663 images belonging to 3 classes.
Found 333 images belonging to 3 classes.
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d_5 (Conv2D)            (None, 147, 147, 32)      1568
_________________________________________________________________
max_pooling2d_5 (MaxPooling2 (None, 73, 73, 32)        0
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 70, 70, 32)        16416
_________________________________________________________________
max_pooling2d_6 (MaxPooling2 (None, 35, 35, 32)        0
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 32, 32, 64)        32832
_________________________________________________________________
max_pooling2d_7 (MaxPooling2 (None, 16, 16, 64)        0
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 13, 13, 128)       131200
_________________________________________________________________
max_pooling2d_8 (MaxPooling2 (None, 6, 6, 128)         0
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 3, 3, 256)         524544
_________________________________________________________________
max_pooling2d_9 (MaxPooling2 (None, 1, 1, 256)         0
_________________________________________________________________
flatten_1 (Flatten)          (None, 256)               0
_________________________________________________________________
dense_2 (Dense)              (None, 512)               131584
_________________________________________________________________
activation_1 (Activation)    (None, 512)               0
_________________________________________________________________
dense_3 (Dense)              (None, 3)                 1539
=================================================================
Total params: 839,683
Trainable params: 839,683
Non-trainable params: 0
_________________________________________________________________
None
73 312
Epoch 1/30
2020-02-27 00:43:50.747185: I tensorflow/core/profiler/lib/profiler_session.cc:184] Profiler session started.
2020-02-27 00:43:50.750613: W tensorflow/core/profiler/lib/profiler_session.cc:192] Encountered error while starting profiler: Unavailable: CUPTI error: CUPTI could not be loaded or symbol could not be found.
  1/312 [..............................] - ETA: 2:14 - loss: 1.0983 - accuracy: 0.31252020-02-27 00:43:50.849410: I tensorflow/core/platform/default/device_tracer.cc:588] Collecting 0 kernel records, 0 memcpy records.
2020-02-27 00:43:50.855086: E tensorflow/core/platform/default/device_tracer.cc:70] CUPTI error: CUPTI could not be loaded or symbol could not be found.
312/312 [==============================] - 67s 216ms/step - loss: 1.0349 - accuracy: 0.4447 - val_loss: 0.9246 - val_accuracy: 0.5106
Epoch 2/30
312/312 [==============================] - 67s 214ms/step - loss: 0.8945 - accuracy: 0.5470 - val_loss: 0.8509 - val_accuracy: 0.5732
Epoch 3/30
312/312 [==============================] - 65s 208ms/step - loss: 0.8318 - accuracy: 0.5849 - val_loss: 0.8370 - val_accuracy: 0.5784
Epoch 4/30
312/312 [==============================] - 66s 211ms/step - loss: 0.8030 - accuracy: 0.6116 - val_loss: 0.7682 - val_accuracy: 0.6252
Epoch 5/30
312/312 [==============================] - 65s 207ms/step - loss: 0.7814 - accuracy: 0.6336 - val_loss: 0.7492 - val_accuracy: 0.6406
Epoch 6/30
312/312 [==============================] - 64s 205ms/step - loss: 0.7637 - accuracy: 0.6426 - val_loss: 0.7565 - val_accuracy: 0.6425
Epoch 7/30
312/312 [==============================] - 64s 206ms/step - loss: 0.7336 - accuracy: 0.6573 - val_loss: 0.7340 - val_accuracy: 0.6497
Epoch 8/30
312/312 [==============================] - 65s 209ms/step - loss: 0.7181 - accuracy: 0.6687 - val_loss: 0.7307 - val_accuracy: 0.6614
Epoch 9/30
312/312 [==============================] - 65s 209ms/step - loss: 0.7068 - accuracy: 0.6715 - val_loss: 0.7040 - val_accuracy: 0.6637
Epoch 10/30
312/312 [==============================] - 64s 207ms/step - loss: 0.6900 - accuracy: 0.6883 - val_loss: 0.6785 - val_accuracy: 0.6987
Epoch 11/30
312/312 [==============================] - 65s 208ms/step - loss: 0.6807 - accuracy: 0.6917 - val_loss: 0.6643 - val_accuracy: 0.7014
Epoch 12/30
312/312 [==============================] - 64s 205ms/step - loss: 0.6662 - accuracy: 0.6978 - val_loss: 0.6968 - val_accuracy: 0.6791
Epoch 13/30
312/312 [==============================] - 64s 206ms/step - loss: 0.6573 - accuracy: 0.7015 - val_loss: 0.6844 - val_accuracy: 0.6851
Epoch 00013: early stopping
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d_5 (Conv2D)            (None, 147, 147, 32)      1568
_________________________________________________________________
max_pooling2d_5 (MaxPooling2 (None, 73, 73, 32)        0
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 70, 70, 32)        16416
_________________________________________________________________
max_pooling2d_6 (MaxPooling2 (None, 35, 35, 32)        0
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 32, 32, 64)        32832
_________________________________________________________________
max_pooling2d_7 (MaxPooling2 (None, 16, 16, 64)        0
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 13, 13, 128)       131200
_________________________________________________________________
max_pooling2d_8 (MaxPooling2 (None, 6, 6, 128)         0
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 3, 3, 256)         524544
_________________________________________________________________
max_pooling2d_9 (MaxPooling2 (None, 1, 1, 256)         0
_________________________________________________________________
flatten_1 (Flatten)          (None, 256)               0
_________________________________________________________________
dense_2 (Dense)              (None, 512)               131584
_________________________________________________________________
activation_1 (Activation)    (None, 512)               0
_________________________________________________________________
dense_3 (Dense)              (None, 3)                 1539
=================================================================
Total params: 839,683
Trainable params: 839,683
Non-trainable params: 0
_________________________________________________________________
None
11/11 [==============================] - 0s 41ms/step - loss: 0.5849 - accuracy: 0.7447
[0.5848517641425133, 0.7447447]
11/11 [==============================] - 0s 38ms/step
Confusion Matrix
[[ 68  15  15]
 [  2 126   1]
 [ 42  10  54]]
Classification Report
              precision    recall  f1-score   support

    bacteria       0.61      0.69      0.65        98
      normal       0.83      0.98      0.90       129
       virus       0.77      0.51      0.61       106

    accuracy                           0.74       333
   macro avg       0.74      0.73      0.72       333
weighted avg       0.75      0.74      0.73       333

[0.5848517641425133, 0.7447447]
Found 2321 images belonging to 3 classes.
Found 663 images belonging to 3 classes.
Found 333 images belonging to 3 classes.
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d_10 (Conv2D)           (None, 147, 147, 32)      1568
_________________________________________________________________
max_pooling2d_10 (MaxPooling (None, 73, 73, 32)        0
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 70, 70, 32)        16416
_________________________________________________________________
max_pooling2d_11 (MaxPooling (None, 35, 35, 32)        0
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 32, 32, 64)        32832
_________________________________________________________________
max_pooling2d_12 (MaxPooling (None, 16, 16, 64)        0
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 13, 13, 128)       131200
_________________________________________________________________
max_pooling2d_13 (MaxPooling (None, 6, 6, 128)         0
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 3, 3, 256)         524544
_________________________________________________________________
max_pooling2d_14 (MaxPooling (None, 1, 1, 256)         0
_________________________________________________________________
flatten_2 (Flatten)          (None, 256)               0
_________________________________________________________________
dense_4 (Dense)              (None, 512)               131584
_________________________________________________________________
activation_2 (Activation)    (None, 512)               0
_________________________________________________________________
dense_5 (Dense)              (None, 3)                 1539
=================================================================
Total params: 839,683
Trainable params: 839,683
Non-trainable params: 0
_________________________________________________________________
None
146 625
Epoch 1/30
2020-02-27 00:57:58.066289: I tensorflow/core/profiler/lib/profiler_session.cc:184] Profiler session started.
2020-02-27 00:57:58.068568: W tensorflow/core/profiler/lib/profiler_session.cc:192] Encountered error while starting profiler: Unavailable: CUPTI error: CUPTI could not be loaded or symbol could not be found.
  1/625 [..............................] - ETA: 3:26 - loss: 1.0988 - accuracy: 0.31252020-02-27 00:57:58.231678: I tensorflow/core/platform/default/device_tracer.cc:588] Collecting 0 kernel records, 0 memcpy records.
2020-02-27 00:57:58.236426: E tensorflow/core/platform/default/device_tracer.cc:70] CUPTI error: CUPTI could not be loaded or symbol could not be found.
625/625 [==============================] - 69s 111ms/step - loss: 1.0801 - accuracy: 0.3963 - val_loss: 1.0684 - val_accuracy: 0.3861
Epoch 2/30
625/625 [==============================] - 68s 109ms/step - loss: 1.0389 - accuracy: 0.4317 - val_loss: 0.9682 - val_accuracy: 0.5253
Epoch 3/30
625/625 [==============================] - 68s 109ms/step - loss: 0.9090 - accuracy: 0.5436 - val_loss: 0.8492 - val_accuracy: 0.5724
Epoch 4/30
625/625 [==============================] - 67s 107ms/step - loss: 0.8339 - accuracy: 0.5925 - val_loss: 0.8397 - val_accuracy: 0.5841
Epoch 5/30
625/625 [==============================] - 67s 107ms/step - loss: 0.7862 - accuracy: 0.6265 - val_loss: 0.9939 - val_accuracy: 0.4872
Epoch 6/30
625/625 [==============================] - 68s 108ms/step - loss: 0.7570 - accuracy: 0.6488 - val_loss: 0.7495 - val_accuracy: 0.6587
Epoch 7/30
625/625 [==============================] - 68s 109ms/step - loss: 0.7287 - accuracy: 0.6624 - val_loss: 0.7697 - val_accuracy: 0.6437
Epoch 8/30
625/625 [==============================] - 69s 110ms/step - loss: 0.7157 - accuracy: 0.6695 - val_loss: 0.7065 - val_accuracy: 0.6916
Epoch 9/30
625/625 [==============================] - 68s 109ms/step - loss: 0.7071 - accuracy: 0.6803 - val_loss: 0.7008 - val_accuracy: 0.6825
Epoch 10/30
625/625 [==============================] - 68s 108ms/step - loss: 0.6934 - accuracy: 0.6875 - val_loss: 0.7192 - val_accuracy: 0.6731
Epoch 11/30
625/625 [==============================] - 68s 108ms/step - loss: 0.6918 - accuracy: 0.6958 - val_loss: 0.6985 - val_accuracy: 0.6806
Epoch 12/30
625/625 [==============================] - 68s 109ms/step - loss: 0.6736 - accuracy: 0.7030 - val_loss: 0.6762 - val_accuracy: 0.6923
Epoch 13/30
625/625 [==============================] - 68s 108ms/step - loss: 0.6741 - accuracy: 0.7017 - val_loss: 0.6665 - val_accuracy: 0.7066
Epoch 14/30
625/625 [==============================] - 68s 109ms/step - loss: 0.6652 - accuracy: 0.7026 - val_loss: 0.7064 - val_accuracy: 0.6750
Epoch 15/30
625/625 [==============================] - 68s 109ms/step - loss: 0.6526 - accuracy: 0.7107 - val_loss: 0.6468 - val_accuracy: 0.7168
Epoch 16/30
625/625 [==============================] - 68s 108ms/step - loss: 0.6452 - accuracy: 0.7135 - val_loss: 0.6756 - val_accuracy: 0.6987
Epoch 17/30
625/625 [==============================] - 68s 108ms/step - loss: 0.6457 - accuracy: 0.7125 - val_loss: 0.6496 - val_accuracy: 0.7010
Epoch 00017: early stopping
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d_10 (Conv2D)           (None, 147, 147, 32)      1568
_________________________________________________________________
max_pooling2d_10 (MaxPooling (None, 73, 73, 32)        0
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 70, 70, 32)        16416
_________________________________________________________________
max_pooling2d_11 (MaxPooling (None, 35, 35, 32)        0
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 32, 32, 64)        32832
_________________________________________________________________
max_pooling2d_12 (MaxPooling (None, 16, 16, 64)        0
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 13, 13, 128)       131200
_________________________________________________________________
max_pooling2d_13 (MaxPooling (None, 6, 6, 128)         0
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 3, 3, 256)         524544
_________________________________________________________________
max_pooling2d_14 (MaxPooling (None, 1, 1, 256)         0
_________________________________________________________________
flatten_2 (Flatten)          (None, 256)               0
_________________________________________________________________
dense_4 (Dense)              (None, 512)               131584
_________________________________________________________________
activation_2 (Activation)    (None, 512)               0
_________________________________________________________________
dense_5 (Dense)              (None, 3)                 1539
=================================================================
Total params: 839,683
Trainable params: 839,683
Non-trainable params: 0
_________________________________________________________________
None
11/11 [==============================] - 0s 43ms/step - loss: 0.6064 - accuracy: 0.7117
[0.6063504273241217, 0.7117117]
11/11 [==============================] - 0s 37ms/step
Confusion Matrix
[[ 64   9  25]
 [ 12 109   8]
 [ 37   5  64]]
Classification Report
              precision    recall  f1-score   support

    bacteria       0.57      0.65      0.61        98
      normal       0.89      0.84      0.87       129
       virus       0.66      0.60      0.63       106

    accuracy                           0.71       333
   macro avg       0.70      0.70      0.70       333
weighted avg       0.72      0.71      0.71       333

[0.6063504273241217, 0.7117117]
Found 2321 images belonging to 3 classes.
Found 663 images belonging to 3 classes.
Found 333 images belonging to 3 classes.
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d_15 (Conv2D)           (None, 147, 147, 32)      1568
_________________________________________________________________
max_pooling2d_15 (MaxPooling (None, 73, 73, 32)        0
_________________________________________________________________
conv2d_16 (Conv2D)           (None, 70, 70, 32)        16416
_________________________________________________________________
max_pooling2d_16 (MaxPooling (None, 35, 35, 32)        0
_________________________________________________________________
conv2d_17 (Conv2D)           (None, 32, 32, 64)        32832
_________________________________________________________________
max_pooling2d_17 (MaxPooling (None, 16, 16, 64)        0
_________________________________________________________________
conv2d_18 (Conv2D)           (None, 13, 13, 128)       131200
_________________________________________________________________
max_pooling2d_18 (MaxPooling (None, 6, 6, 128)         0
_________________________________________________________________
conv2d_19 (Conv2D)           (None, 3, 3, 256)         524544
_________________________________________________________________
max_pooling2d_19 (MaxPooling (None, 1, 1, 256)         0
_________________________________________________________________
flatten_3 (Flatten)          (None, 256)               0
_________________________________________________________________
dense_6 (Dense)              (None, 512)               131584
_________________________________________________________________
activation_3 (Activation)    (None, 512)               0
_________________________________________________________________
dense_7 (Dense)              (None, 3)                 1539
=================================================================
Total params: 839,683
Trainable params: 839,683
Non-trainable params: 0
_________________________________________________________________
None
194 833
Epoch 1/30
2020-02-27 01:17:13.590707: I tensorflow/core/profiler/lib/profiler_session.cc:184] Profiler session started.
2020-02-27 01:17:13.593158: W tensorflow/core/profiler/lib/profiler_session.cc:192] Encountered error while starting profiler: Unavailable: CUPTI error: CUPTI could not be loaded or symbol could not be found.
  1/833 [..............................] - ETA: 3:58 - loss: 1.0965 - accuracy: 0.58332020-02-27 01:17:13.663165: I tensorflow/core/platform/default/device_tracer.cc:588] Collecting 0 kernel records, 0 memcpy records.
2020-02-27 01:17:13.667728: E tensorflow/core/platform/default/device_tracer.cc:70] CUPTI error: CUPTI could not be loaded or symbol could not be found.
833/833 [==============================] - 69s 83ms/step - loss: 1.0950 - accuracy: 0.3843 - val_loss: 1.0779 - val_accuracy: 0.3851
Epoch 2/30
833/833 [==============================] - 68s 82ms/step - loss: 1.0743 - accuracy: 0.3964 - val_loss: 1.0530 - val_accuracy: 0.4429
Epoch 3/30
833/833 [==============================] - 70s 84ms/step - loss: 0.9204 - accuracy: 0.5348 - val_loss: 0.8505 - val_accuracy: 0.5961
Epoch 4/30
833/833 [==============================] - 70s 84ms/step - loss: 0.8403 - accuracy: 0.6004 - val_loss: 0.8029 - val_accuracy: 0.6164
Epoch 5/30
833/833 [==============================] - 69s 83ms/step - loss: 0.7894 - accuracy: 0.6303 - val_loss: 0.7605 - val_accuracy: 0.6408
Epoch 6/30
833/833 [==============================] - 69s 83ms/step - loss: 0.7654 - accuracy: 0.6467 - val_loss: 0.7866 - val_accuracy: 0.6370
Epoch 7/30
833/833 [==============================] - 70s 84ms/step - loss: 0.7470 - accuracy: 0.6630 - val_loss: 0.7678 - val_accuracy: 0.6490
Epoch 00007: early stopping
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d_15 (Conv2D)           (None, 147, 147, 32)      1568
_________________________________________________________________
max_pooling2d_15 (MaxPooling (None, 73, 73, 32)        0
_________________________________________________________________
conv2d_16 (Conv2D)           (None, 70, 70, 32)        16416
_________________________________________________________________
max_pooling2d_16 (MaxPooling (None, 35, 35, 32)        0
_________________________________________________________________
conv2d_17 (Conv2D)           (None, 32, 32, 64)        32832
_________________________________________________________________
max_pooling2d_17 (MaxPooling (None, 16, 16, 64)        0
_________________________________________________________________
conv2d_18 (Conv2D)           (None, 13, 13, 128)       131200
_________________________________________________________________
max_pooling2d_18 (MaxPooling (None, 6, 6, 128)         0
_________________________________________________________________
conv2d_19 (Conv2D)           (None, 3, 3, 256)         524544
_________________________________________________________________
max_pooling2d_19 (MaxPooling (None, 1, 1, 256)         0
_________________________________________________________________
flatten_3 (Flatten)          (None, 256)               0
_________________________________________________________________
dense_6 (Dense)              (None, 512)               131584
_________________________________________________________________
activation_3 (Activation)    (None, 512)               0
_________________________________________________________________
dense_7 (Dense)              (None, 3)                 1539
=================================================================
Total params: 839,683
Trainable params: 839,683
Non-trainable params: 0
_________________________________________________________________
None
11/11 [==============================] - 0s 39ms/step - loss: 0.6853 - accuracy: 0.6817
[0.6853103962811556, 0.6816817]
11/11 [==============================] - 0s 39ms/step
Confusion Matrix
[[ 45  23  30]
 [  5 114  10]
 [ 30   8  68]]
Classification Report
              precision    recall  f1-score   support

    bacteria       0.56      0.46      0.51        98
      normal       0.79      0.88      0.83       129
       virus       0.63      0.64      0.64       106

    accuracy                           0.68       333
   macro avg       0.66      0.66      0.66       333
weighted avg       0.67      0.68      0.67       333

[0.6853103962811556, 0.6816817]
Found 2321 images belonging to 3 classes.
Found 663 images belonging to 3 classes.
Found 333 images belonging to 3 classes.
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d_20 (Conv2D)           (None, 147, 147, 32)      1568
_________________________________________________________________
max_pooling2d_20 (MaxPooling (None, 73, 73, 32)        0
_________________________________________________________________
conv2d_21 (Conv2D)           (None, 70, 70, 32)        16416
_________________________________________________________________
max_pooling2d_21 (MaxPooling (None, 35, 35, 32)        0
_________________________________________________________________
conv2d_22 (Conv2D)           (None, 32, 32, 64)        32832
_________________________________________________________________
max_pooling2d_22 (MaxPooling (None, 16, 16, 64)        0
_________________________________________________________________
conv2d_23 (Conv2D)           (None, 13, 13, 128)       131200
_________________________________________________________________
max_pooling2d_23 (MaxPooling (None, 6, 6, 128)         0
_________________________________________________________________
conv2d_24 (Conv2D)           (None, 3, 3, 256)         524544
_________________________________________________________________
max_pooling2d_24 (MaxPooling (None, 1, 1, 256)         0
_________________________________________________________________
flatten_4 (Flatten)          (None, 256)               0
_________________________________________________________________
dense_8 (Dense)              (None, 512)               131584
_________________________________________________________________
activation_4 (Activation)    (None, 512)               0
_________________________________________________________________
dense_9 (Dense)              (None, 3)                 1539
=================================================================
Total params: 839,683
Trainable params: 839,683
Non-trainable params: 0
_________________________________________________________________
None
291 1250
Epoch 1/30
2020-02-27 01:25:21.848858: I tensorflow/core/profiler/lib/profiler_session.cc:184] Profiler session started.
2020-02-27 01:25:21.850837: W tensorflow/core/profiler/lib/profiler_session.cc:192] Encountered error while starting profiler: Unavailable: CUPTI error: CUPTI could not be loaded or symbol could not be found.
   1/1250 [..............................] - ETA: 4:42 - loss: 1.0988 - accuracy: 0.25002020-02-27 01:25:21.983471: I tensorflow/core/platform/default/device_tracer.cc:588] Collecting 0 kernel records, 0 memcpy records.
2020-02-27 01:25:21.989017: E tensorflow/core/platform/default/device_tracer.cc:70] CUPTI error: CUPTI could not be loaded or symbol could not be found.
1250/1250 [==============================] - 72s 58ms/step - loss: 1.0964 - accuracy: 0.3852 - val_loss: 1.0929 - val_accuracy: 0.3860
Epoch 2/30
1250/1250 [==============================] - 71s 57ms/step - loss: 1.0993 - accuracy: 0.3843 - val_loss: 1.0922 - val_accuracy: 0.3856
Epoch 3/30
1250/1250 [==============================] - 73s 58ms/step - loss: 1.0895 - accuracy: 0.3880 - val_loss: 1.0820 - val_accuracy: 0.3841
Epoch 4/30
1250/1250 [==============================] - 72s 57ms/step - loss: 1.0834 - accuracy: 0.3819 - val_loss: 1.0916 - val_accuracy: 0.3856
Epoch 5/30
1250/1250 [==============================] - 72s 57ms/step - loss: 1.0782 - accuracy: 0.3835 - val_loss: 1.0664 - val_accuracy: 0.3856
Epoch 6/30
1250/1250 [==============================] - 72s 57ms/step - loss: 1.0631 - accuracy: 0.4023 - val_loss: 1.0581 - val_accuracy: 0.4034
Epoch 7/30
1250/1250 [==============================] - 72s 58ms/step - loss: 0.9633 - accuracy: 0.5196 - val_loss: 0.8799 - val_accuracy: 0.5765
Epoch 8/30
1250/1250 [==============================] - 72s 57ms/step - loss: 0.8776 - accuracy: 0.5739 - val_loss: 0.8413 - val_accuracy: 0.5892
Epoch 9/30
1250/1250 [==============================] - 72s 57ms/step - loss: 0.8283 - accuracy: 0.5959 - val_loss: 0.8919 - val_accuracy: 0.5732
Epoch 10/30
1250/1250 [==============================] - 71s 57ms/step - loss: 0.8079 - accuracy: 0.6157 - val_loss: 0.7873 - val_accuracy: 0.6204
Epoch 11/30
1250/1250 [==============================] - 73s 58ms/step - loss: 0.8002 - accuracy: 0.6152 - val_loss: 0.8007 - val_accuracy: 0.6200
Epoch 12/30
1250/1250 [==============================] - 72s 58ms/step - loss: 0.7780 - accuracy: 0.6361 - val_loss: 0.7589 - val_accuracy: 0.6393
Epoch 13/30
1250/1250 [==============================] - 72s 57ms/step - loss: 0.7661 - accuracy: 0.6422 - val_loss: 0.8009 - val_accuracy: 0.6144
Epoch 14/30
1250/1250 [==============================] - 72s 57ms/step - loss: 0.7520 - accuracy: 0.6499 - val_loss: 0.7429 - val_accuracy: 0.6564
Epoch 15/30
1250/1250 [==============================] - 73s 58ms/step - loss: 0.7432 - accuracy: 0.6496 - val_loss: 0.7260 - val_accuracy: 0.6828
Epoch 16/30
1250/1250 [==============================] - 72s 58ms/step - loss: 0.7336 - accuracy: 0.6636 - val_loss: 0.7127 - val_accuracy: 0.6753
Epoch 17/30
1250/1250 [==============================] - 72s 57ms/step - loss: 0.7194 - accuracy: 0.6713 - val_loss: 0.7149 - val_accuracy: 0.6787
Epoch 18/30
1250/1250 [==============================] - 73s 58ms/step - loss: 0.7296 - accuracy: 0.6659 - val_loss: 0.6992 - val_accuracy: 0.6828
Epoch 19/30
1250/1250 [==============================] - 72s 57ms/step - loss: 0.7083 - accuracy: 0.6829 - val_loss: 0.7177 - val_accuracy: 0.6664
Epoch 20/30
1250/1250 [==============================] - 72s 57ms/step - loss: 0.7007 - accuracy: 0.6804 - val_loss: 0.7101 - val_accuracy: 0.6850
Epoch 00020: early stopping
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d_20 (Conv2D)           (None, 147, 147, 32)      1568
_________________________________________________________________
max_pooling2d_20 (MaxPooling (None, 73, 73, 32)        0
_________________________________________________________________
conv2d_21 (Conv2D)           (None, 70, 70, 32)        16416
_________________________________________________________________
max_pooling2d_21 (MaxPooling (None, 35, 35, 32)        0
_________________________________________________________________
conv2d_22 (Conv2D)           (None, 32, 32, 64)        32832
_________________________________________________________________
max_pooling2d_22 (MaxPooling (None, 16, 16, 64)        0
_________________________________________________________________
conv2d_23 (Conv2D)           (None, 13, 13, 128)       131200
_________________________________________________________________
max_pooling2d_23 (MaxPooling (None, 6, 6, 128)         0
_________________________________________________________________
conv2d_24 (Conv2D)           (None, 3, 3, 256)         524544
_________________________________________________________________
max_pooling2d_24 (MaxPooling (None, 1, 1, 256)         0
_________________________________________________________________
flatten_4 (Flatten)          (None, 256)               0
_________________________________________________________________
dense_8 (Dense)              (None, 512)               131584
_________________________________________________________________
activation_4 (Activation)    (None, 512)               0
_________________________________________________________________
dense_9 (Dense)              (None, 3)                 1539
=================================================================
Total params: 839,683
Trainable params: 839,683
Non-trainable params: 0
_________________________________________________________________
None
11/11 [==============================] - 0s 42ms/step - loss: 0.6510 - accuracy: 0.7117
[0.6510399200699546, 0.7117117]
11/11 [==============================] - 0s 37ms/step
Confusion Matrix
[[ 35  27  36]
 [  5 120   4]
 [ 11  13  82]]
Classification Report
              precision    recall  f1-score   support

    bacteria       0.69      0.36      0.47        98
      normal       0.75      0.93      0.83       129
       virus       0.67      0.77      0.72       106

    accuracy                           0.71       333
   macro avg       0.70      0.69      0.67       333
weighted avg       0.71      0.71      0.69       333

[0.6510399200699546, 0.7117117]

